<!DOCTYPE HTML>
<html lang="es" data-theme="light">
<head>
  <meta charset="utf-8" />
  <title>Recursos ‚Äì Sanaci√≥n & Narcisismo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Herramientas gratuitas: checklist de banderas rojas, generador de l√≠mites, contador de d√≠as y respiraci√≥n guiada.">
  <link rel="canonical" href="https://bjpages.github.io/sanandoando/recursos/">
  <link rel="stylesheet" href="../assets/css/main.css" />
  <noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
  <style>
    /* ====== Tema claro/oscuro con CSS vars ====== */
    :root{
      --bg:#ffffff;
      --card:#ffffff;
      --text:#1c1d26;
      --muted:#666;
      --line:#eee;
      --btn:#f9f9fb;
      --btn-border:#ddd;
      --accent:#1c1d26;
      --pill:#f4f6f8;
      --pill-border:#e5e5e5;
      --ok:#00c170;
      --link:#1b8cff;
    }
    html[data-theme="dark"]{
      --bg:#0f1115;
      --card:#12141a;
      --text:#e9ecf1;
      --muted:#a0a6b0;
      --line:#1f232b;
      --btn:#151922;
      --btn-border:#242a34;
      --accent:#e9ecf1;
      --pill:#19202a;
      --pill-border:#243042;
      --ok:#1fd39f;
      --link:#72b7ff;
    }
    body{ background:var(--bg); color:var(--text); }

    /* Estilos suaves para widgets */
    .tool-card{ background:var(--card); border:1px solid var(--line); border-radius:14px; padding:16px; margin:14px 0; box-shadow:0 8px 20px rgba(0,0,0,.03); }
    .tool-title{ margin-top:0; }
    .pill{ display:inline-block; padding:.25rem .6rem; border-radius:999px; border:1px solid var(--pill-border); font-size:.85rem; color:var(--text); background:var(--pill); }
    .meter{ height:10px; background:var(--line); border-radius:999px; overflow:hidden; }
    .meter > span{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#00c170,#ffb800,#ff5f5f); transition:width .25s ease; }
    .row2{ display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    @media(max-width:800px){ .row2{ grid-template-columns:1fr; } }
    .small{ font-size:.9rem; color:var(--muted); }
    .muted{ color:var(--muted); }
    .inline-controls > *{ margin-right:8px; margin-bottom:8px; }
    .btn{ display:inline-block; padding:.6rem .9rem; border-radius:10px; border:1px solid var(--btn-border); background:var(--btn); cursor:pointer; color:var(--text); }
    .btn.primary{ background:var(--accent); color:#fff; border-color:var(--accent); }
    .btn.ghost{ background:transparent; }
    .copy-ok{ color:var(--ok); font-weight:700; margin-left:8px; display:none; }
    /* Box breathing */
    .box-wrap{ display:flex; justify-content:center; align-items:center; height:220px; }
    .box{ width:120px; height:120px; border:2px solid var(--accent); border-radius:14px; display:flex; align-items:center; justify-content:center; font-weight:700; }
    .phase{ margin-top:10px; text-align:center; font-weight:600; }
    .kudos{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .badge{ padding:.2rem .5rem; background:#f2f7ff; border:1px solid #dfe8ff; border-radius:999px; font-size:.8rem; color:#355; }
    html[data-theme="dark"] .badge{ background:#0c223a; border-color:#183a61; color:#cfe2ff; }
    /* Checklist tabla */
    .table{ width:100%; border-collapse:collapse; }
    .table th, .table td{ border-bottom:1px solid var(--line); padding:.5rem; text-align:left; }
    /* Header row tweaks */
    #res-header-actions{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:10px; }
    a{ color:var(--link); }
    /* Print view: solo el contenido marcado con .printable */
    @media print{
      nav.nav-global, #site-header, #site-footer, .no-print, .btn, .inline-controls, .tool-card > .muted { display:none !important; }
      .printable{ display:block !important; }
      body{ background:#fff !important; color:#000 !important; }
    }
  </style>
</head>
<body class="is-preload">
  <!-- Header global -->
  <div id="site-header"></div>

  <section id="header">
    <div class="inner">
      <h1>Recursos gratuitos</h1>
      <p>Herramientas pr√°cticas para tu proceso, hechas para usarse aqu√≠ mismo.</p>
      <div class="pill">Funciona offline</div>
      <div class="pill">Guarda progreso local</div>
      <div id="res-header-actions" class="no-print">
        <button id="theme-toggle" class="btn">üåó Modo oscuro</button>
        <span class="small muted">Estad√≠sticas locales: <span id="stats-line">‚Äî</span></span>
      </div>
    </div>
  </section>

  <section id="one" class="main style1">
    <div class="container">

      <!-- 1) CHECKLIST DE BANDERAS ROJAS -->
      <div class="tool-card" id="tool-flags">
        <h2 class="tool-title">Checklist de banderas rojas</h2>
        <p class="muted">Marca se√±ales que hayas notado. El indicador se actualiza autom√°ticamente. <span class="small">Tu selecci√≥n se guarda en este navegador.</span></p>
        <div class="row2">
          <div>
            <table class="table">
              <thead><tr><th>Se√±al</th><th>¬øLa has visto?</th></tr></thead>
              <tbody id="flags-body"></tbody>
            </table>
          </div>
          <div>
            <p><strong>Indicador de riesgo</strong></p>
            <div class="meter"><span id="flags-meter"></span></div>
            <p id="flags-score" class="small" style="margin-top:.5rem">0 de 0 marcadas</p>
            <p id="flags-hint" class="muted"></p>
            <div class="inline-controls" style="margin-top:.5rem">
              <button class="btn ghost" id="flags-clear">Limpiar</button>
              <button class="btn" id="flags-export">Exportar selecci√≥n (JSON)</button>
              <button class="btn" id="flags-print">Imprimir / Guardar PDF</button>
            </div>
            <!-- Vista imprimible -->
            <div id="flags-printable" class="printable" style="display:none; margin-top:1rem;">
              <h3>Checklist de banderas rojas (resumen)</h3>
              <ul id="flags-print-list"></ul>
              <p class="small">Generado: <span id="flags-print-date"></span></p>
            </div>
          </div>
        </div>
      </div>

      <!-- 2) GENERADOR DE L√çMITES -->
      <div class="tool-card" id="tool-boundaries">
        <h2 class="tool-title">Generador de l√≠mites (frase lista para copiar)</h2>
        <div class="inline-controls">
          <label>Situaci√≥n:
            <select id="b-situation">
              <option value="tono">Cuando el tono se vuelve despectivo</option>
              <option value="mensajes">Mensajes fuera de horario</option>
              <option value="invade">Invasi√≥n de privacidad</option>
              <option value="promesas">Promesas incumplidas repetidas</option>
            </select>
          </label>
          <label>Tono:
            <select id="b-tone">
              <option value="neutral">Neutral y claro</option>
              <option value="firme">Firme</option>
              <option value="empatico">Emp√°tico</option>
            </select>
          </label>
          <button class="btn" id="b-generate">Generar</button>
        </div>
        <p class="small muted" style="margin:.5rem 0 0">Tip: un l√≠mite es observable y medible (qu√© har√°s si se cruza).</p>
        <textarea id="b-output" rows="4" style="width:100%;margin-top:.75rem" placeholder="Aqu√≠ aparecer√° tu l√≠mite..."></textarea>
        <div style="margin-top:.5rem" class="inline-controls">
          <button class="btn primary" id="b-copy">Copiar</button>
          <button class="btn" id="b-print">Imprimir / Guardar PDF</button>
          <span id="b-copied" class="copy-ok">¬°Copiado!</span>
        </div>
        <!-- Bloque imprimible -->
        <div id="b-printable" class="printable" style="display:none; margin-top:1rem;">
          <h3>L√≠mite generado</h3>
          <p id="b-print-text" style="white-space:pre-wrap"></p>
          <p class="small">Generado: <span id="b-print-date"></span></p>
        </div>
      </div>

      <!-- 3) CONTADOR DE D√çAS / STREAK -->
      <div class="tool-card" id="tool-streak">
        <h2 class="tool-title">Contador de d√≠as (No-Contact / h√°bito)</h2>
        <div class="inline-controls">
          <label>Fecha de inicio: <input type="date" id="s-start"></label>
          <button class="btn" id="s-save">Guardar</button>
          <button class="btn ghost" id="s-reset">Reiniciar</button>
          <button class="btn" id="s-print">Imprimir progreso</button>
        </div>
        <p style="margin-top:.5rem">Llevas <strong id="s-days">0</strong> d√≠a(s). <span id="s-phrase" class="muted"></span></p>
        <div class="kudos" id="s-kudos"></div>
        <!-- Imprimible -->
        <div id="s-printable" class="printable" style="display:none; margin-top:1rem;">
          <h3>Progreso de d√≠as</h3>
          <p>Fecha de inicio: <span id="s-print-start">‚Äî</span></p>
          <p>D√≠as acumulados: <span id="s-print-days">0</span></p>
          <p class="small">Generado: <span id="s-print-date"></span></p>
        </div>
      </div>

      <!-- 4) RESPIRACI√ìN 4-4-4 -->
      <div class="tool-card" id="tool-breathe">
        <h2 class="tool-title">Respiraci√≥n 4-4-4 (box breathing)</h2>
        <div class="box-wrap">
          <div class="box" id="br-box">4</div>
        </div>
        <div class="phase" id="br-phase">Inhala</div>
        <div style="text-align:center;margin-top:.5rem">
          <button class="btn primary" id="br-start">Iniciar</button>
          <button class="btn ghost" id="br-stop">Detener</button>
        </div>
        <p class="small muted" style="text-align:center;margin-top:.5rem">Ciclo: 4s Inhala ¬∑ 4s Mant√©n ¬∑ 4s Exhala. Repite 3‚Äì5 minutos.</p>
      </div>

    </div>
  </section>

  <div id="site-footer"></div>

  <!-- Scripts plantilla -->
  <script src="../assets/js/jquery.min.js"></script>
  <script src="../assets/js/browser.min.js"></script>
  <script src="../assets/js/breakpoints.min.js"></script>
  <script src="../assets/js/util.js"></script>
  <script src="../assets/js/main.js"></script>

  <!-- Header / Footer globales -->
  <script src="../assets/js/header.js" data-base="/sanandoando/"></script>
  <script src="../assets/js/footer.js"
          data-base="/sanandoando/"
          data-facebook="https://www.facebook.com/sanando.ando.ya"></script>

  <!-- L√≥gica de herramientas -->
  <script>
    // ====== Utilidades comunes ======
    function saveStat(key){
      try{
        var k = 'sa_stats';
        var obj = JSON.parse(localStorage.getItem(k) || '{}');
        obj[key] = (obj[key] || 0) + 1;
        localStorage.setItem(k, JSON.stringify(obj));
        renderStats();
      }catch(e){}
    }
    function renderStats(){
      try{
        var obj = JSON.parse(localStorage.getItem('sa_stats') || '{}');
        var txt = [
          'Checklist: ' + (obj.flags || 0),
          'L√≠mites: ' + (obj.boundaries || 0),
          'Streak: ' + (obj.streak || 0),
          'Respira: ' + (obj.breathe || 0)
        ].join(' ¬∑ ');
        document.getElementById('stats-line').textContent = txt;
      }catch(e){}
    }
    // Tema
    (function(){
      var html = document.documentElement;
      var key = 'sa_theme';
      function apply(theme){ html.setAttribute('data-theme', theme); }
      function toggle(){
        var cur = html.getAttribute('data-theme') || 'light';
        var next = (cur === 'light' ? 'dark' : 'light');
        apply(next); localStorage.setItem(key, next);
      }
      var saved = localStorage.getItem(key); if(saved) apply(saved);
      var btn = document.getElementById('theme-toggle');
      if(btn){
        btn.addEventListener('click', toggle);
        btn.textContent = (html.getAttribute('data-theme')==='dark'?'üåû Modo claro':'üåó Modo oscuro');
        new MutationObserver(function(){
          btn.textContent = (html.getAttribute('data-theme')==='dark'?'üåû Modo claro':'üåó Modo oscuro');
        }).observe(document.documentElement,{attributes:true,attributeFilter:['data-theme']});
      }
      renderStats();
    })();

    // ---------- 1) CHECKLIST DE BANDERAS ROJAS ----------
    (function(){
      var FLAGS = [
        "Minimiza o ridiculiza tus emociones",
        "Cambia versiones de los hechos (gaslighting)",
        "Te a√≠sla de amistades o familia",
        "Cruza l√≠mites que ya comunicaste",
        "Promete cambiar sin evidencia de cambio",
        "Controla tu tiempo, dinero o decisiones",
        "Usa sarcasmo/desprecio como ‚Äúbroma‚Äù",
        "Vive en modo v√≠ctima para evitar responsabilidad",
        "Invade tu privacidad (tel√©fono, redes, mail)",
        "Presiona para respuestas inmediatas a cualquier hora"
      ];
      var key = "sa_flags";
      var saved = JSON.parse(localStorage.getItem(key) || "[]");
      var body = document.getElementById('flags-body');
      var meter = document.getElementById('flags-meter');
      var score = document.getElementById('flags-score');
      var hint  = document.getElementById('flags-hint');
      var printable = document.getElementById('flags-printable');
      var plist = document.getElementById('flags-print-list');
      var pdate = document.getElementById('flags-print-date');

      function render(){
        body.innerHTML = "";
        FLAGS.forEach(function(txt, i){
          var tr = document.createElement('tr');
          var td1 = document.createElement('td'); td1.textContent = txt;
          var td2 = document.createElement('td');
          var cb = document.createElement('input'); cb.type='checkbox'; cb.checked = saved.indexOf(i)>-1;
          cb.addEventListener('change', function(){
            var idx = saved.indexOf(i);
            if (cb.checked && idx===-1) saved.push(i);
            if (!cb.checked && idx>-1) saved.splice(idx,1);
            localStorage.setItem(key, JSON.stringify(saved));
            updateMeter();
            saveStat('flags');
          });
          td2.appendChild(cb);
          tr.appendChild(td1); tr.appendChild(td2);
          body.appendChild(tr);
        });
        updateMeter();
      }
      function updateMeter(){
        var pct = Math.round((saved.length / FLAGS.length) * 100);
        meter.style.width = pct + '%';
        score.textContent = saved.length + ' de ' + FLAGS.length + ' marcadas';
        if (pct <= 25)      hint.textContent = "Riesgo bajo: sigue atento a los patrones.";
        else if (pct <= 50) hint.textContent = "Riesgo moderado: considera l√≠mites claros y apoyo externo.";
        else if (pct <= 75) hint.textContent = "Riesgo alto: prioriza tu seguridad emocional y busca orientaci√≥n.";
        else                hint.textContent = "Riesgo muy alto: considera plan de salida y apoyo profesional.";
      }
      document.getElementById('flags-clear').addEventListener('click', function(){
        saved = []; localStorage.setItem(key, "[]"); render();
      });
      document.getElementById('flags-export').addEventListener('click', function(){
        var selected = saved.map(function(i){ return FLAGS[i]; });
        var blob = new Blob([JSON.stringify({selected:selected, total:FLAGS.length, date:new Date().toISOString()}, null, 2)], {type:"application/json"});
        var a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'banderas_rojas.json';
        a.click();
        saveStat('flags');
      });
      document.getElementById('flags-print').addEventListener('click', function(){
        // Construir lista imprimible
        plist.innerHTML = '';
        var selected = saved.map(function(i){ return FLAGS[i]; });
        if (selected.length === 0) { plist.innerHTML = '<li>(Sin elementos marcados)</li>'; }
        else selected.forEach(function(t){ var li=document.createElement('li'); li.textContent=t; plist.appendChild(li); });
        pdate.textContent = new Date().toLocaleString();
        printable.style.display = 'block';
        window.print();
        setTimeout(function(){ printable.style.display='none'; }, 500);
        saveStat('flags');
      });
      render();
    })();

    // ---------- 2) GENERADOR DE L√çMITES ----------
    (function(){
      var TEMPLATES = {
        tono: {
          neutral:  "Cuando el tono se vuelve despectivo, me retiro de la conversaci√≥n. Podemos seguir cuando el trato sea respetuoso.",
          firme:    "No tolerar√© un tono despectivo. Si sucede, terminar√© la conversaci√≥n y retomar√© cuando podamos hablar con respeto.",
          empatico: "Me afecta cuando el tono suena despectivo. Para cuidarme, pausar√© la conversaci√≥n y la retomamos con respeto."
        },
        mensajes: {
          neutral:  "No respondo mensajes despu√©s de las 22:00. Si escribes en ese horario, te contestar√© al d√≠a siguiente.",
          firme:    "No contestar√© mensajes fuera de horario. Si llegan, responder√© al d√≠a siguiente.",
          empatico: "Necesito descanso. Si me escribes tarde, te responder√© ma√±ana."
        },
        invade: {
          neutral:  "No comparto contrase√±as ni acceso a mis cuentas. Si se insiste, cortar√© la conversaci√≥n.",
          firme:    "No permitir√© invasi√≥n de mi privacidad. No compartir√© contrase√±as ni accesos.",
          empatico: "Para sentirme seguro, necesito privacidad. No compartir√© contrase√±as ni acceso."
        },
        promesas: {
          neutral:  "Cuando hay promesas que no se cumplen, replanteo mi participaci√≥n. Necesito hechos consistentes.",
          firme:    "Si las promesas no se cumplen repetidamente, me apartar√© de esos acuerdos.",
          empatico: "Me frustra cuando lo acordado no se cumple. Necesito consistencia para seguir."
        }
      };
      var s = document.getElementById('b-situation');
      var t = document.getElementById('b-tone');
      var out = document.getElementById('b-output');
      var pwrap = document.getElementById('b-printable');
      var ptext = document.getElementById('b-print-text');
      var pdate = document.getElementById('b-print-date');

      function gen(){
        var txt = (TEMPLATES[s.value] && TEMPLATES[s.value][t.value]) || '';
        out.value = txt;
        saveStat('boundaries');
      }
      document.getElementById('b-generate').addEventListener('click', gen);
      document.getElementById('b-copy').addEventListener('click', function(){
        out.select(); document.execCommand('copy');
        var ok = document.getElementById('b-copied'); ok.style.display='inline';
        setTimeout(function(){ ok.style.display='none'; }, 1400);
        saveStat('boundaries');
      });
      document.getElementById('b-print').addEventListener('click', function(){
        ptext.textContent = out.value || '(Sin contenido)';
        pdate.textContent = new Date().toLocaleString();
        pwrap.style.display = 'block';
        window.print();
        setTimeout(function(){ pwrap.style.display='none'; }, 500);
        saveStat('boundaries');
      });
      gen();
    })();

    // ---------- 3) CONTADOR DE D√çAS ----------
    (function(){
      var key = 'sa_streak_start';
      var startInput = document.getElementById('s-start');
      var daysEl = document.getElementById('s-days');
      var phrase = document.getElementById('s-phrase');
      var kudos = document.getElementById('s-kudos');
      var pwrap = document.getElementById('s-printable');
      var pstart = document.getElementById('s-print-start');
      var pdays  = document.getElementById('s-print-days');
      var pdate  = document.getElementById('s-print-date');

      function load(){
        var stored = localStorage.getItem(key);
        if (stored) startInput.value = stored;
        update();
      }
      function update(){
        var v = startInput.value;
        if (!v){ daysEl.textContent = '0'; phrase.textContent=''; kudos.innerHTML=''; return; }
        var d0 = new Date(v+'T00:00:00');
        var now = new Date();
        var diff = Math.floor((now - d0) / (1000*60*60*24));
        if (diff < 0) diff = 0;
        daysEl.textContent = diff;
        phrase.textContent = diff>=1 ? '¬°Sigue as√≠!' : 'Selecciona una fecha de inicio.';
        renderBadges(diff);
      }
      function renderBadges(n){
        var milestones = [1,3,7,14,21,30,60,90];
        kudos.innerHTML = milestones.filter(function(m){ return n>=m; })
          .map(function(m){ return '<span class="badge">üéâ ' + m + ' d√≠a' + (m>1?'s':'') + '</span>'; })
          .join('');
      }
      document.getElementById('s-save').addEventListener('click', function(){
        if (startInput.value){ localStorage.setItem(key, startInput.value); update(); saveStat('streak'); }
      });
      document.getElementById('s-reset').addEventListener('click', function(){
        localStorage.removeItem(key); startInput.value=''; update(); saveStat('streak');
      });
      document.getElementById('s-print').addEventListener('click', function(){
        var v = startInput.value;
        pstart.textContent = v || '(sin fecha)';
        pdays.textContent = document.getElementById('s-days').textContent;
        pdate.textContent = new Date().toLocaleString();
        pwrap.style.display = 'block';
        window.print();
        setTimeout(function(){ pwrap.style.display='none'; }, 500);
        saveStat('streak');
      });
      startInput.addEventListener('change', function(){ update(); saveStat('streak'); });
      load();
    })();

    // ---------- 4) RESPIRACI√ìN 4-4-4 ----------
    (function(){
      var box = document.getElementById('br-box');
      var phaseEl = document.getElementById('br-phase');
      var timer = null;
      var i = 0; // 0=inhala,1=mant√©n,2=exhala
      var secs = 4, remain = 4;

      function setPhase(p){
        i = p; remain = secs;
        var label = (i===0?'Inhala': i===1?'Mant√©n':'Exhala');
        phaseEl.textContent = label;
        box.style.transform = (i===0?'scale(1.06)': i===1?'scale(1.06)':'scale(0.94)');
      }
      function tick(){
        box.textContent = remain;
        remain--;
        if (remain < 0){
          setPhase((i+1)%3);
        }
      }
      function start(){
        stop(); setPhase(0); tick();
        timer = setInterval(tick, 1000);
        saveStat('breathe');
      }
      function stop(){
        if (timer) clearInterval(timer);
        timer = null; box.textContent = '4'; phaseEl.textContent = 'Inhala'; box.style.transform='scale(1)';
      }
      document.getElementById('br-start').addEventListener('click', start);
      document.getElementById('br-stop').addEventListener('click', stop);
    })();
  </script>
</body>
</html>
